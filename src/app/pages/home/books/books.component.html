<mat-card>
	<ul>
		<li>
			<button mat-raised-button color="secondary"  mat-icon-button (click)="loadBooks()">
				<mat-icon>
					book
				</mat-icon>
			  </button>
		</li>
		<li>
			<button mat-raised-button color="secondary"  mat-icon-button (click)="loadAuthors()">
				<mat-icon>
					person
				</mat-icon>
			  </button>
		</li>
		<li>
			<button mat-raised-button color="secondary"  mat-icon-button (click)="loadPublishers()">
				<mat-icon>
					account_balance
				</mat-icon>
			  </button>
		</li>

		<li>
			<button mat-raised-button color="secondary"  mat-icon-button (click)="addBook()">
				<mat-icon>
					add
				</mat-icon>
			  </button>
		</li>
	</ul>
	<hr>

	<table mat-table [dataSource]="dataSource" class="mat-elevation-z8" *ngIf="displayTable">
	  
		<ng-container matColumnDef="titulo">
			<th mat-header-cell *matHeaderCellDef>Título</th>
			<td mat-cell *matCellDef="let element">{{element.title}}</td>
		</ng-container>
	  
		<ng-container matColumnDef="autor">
			<th mat-header-cell *matHeaderCellDef>Autor</th>
			<td mat-cell *matCellDef="let element">{{element.authorName}}</td>
		</ng-container>
	  
		<ng-container matColumnDef="editora">
			<th mat-header-cell *matHeaderCellDef>Editora</th>
			<td mat-cell *matCellDef="let element">{{element.publisher.publisherName}}</td>
		</ng-container>
	  
		<ng-container matColumnDef="quantidade">
			<th class="col" mat-header-cell *matHeaderCellDef>Quantidade</th>
			<td class="col" mat-cell *matCellDef="let element">{{element.availableAmount}}</td>
		</ng-container>

		<ng-container matColumnDef="edit">
			<th class="col" mat-header-cell *matHeaderCellDef>Editar</th>
			<td class="col" mat-cell *matCellDef="let element"><mat-icon>edit</mat-icon></td>
		</ng-container>

		<ng-container matColumnDef="remove">
			<th class="col" mat-header-cell *matHeaderCellDef>Remover</th>
			<td class="col" mat-cell *matCellDef="let element"><mat-icon>delete_forever</mat-icon></td>
		</ng-container>
		
		<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
		<tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
	</table>

	<mat-paginator
		[length]="dataSource.source.length"
		[pageSize]="10"
		[pageSizeOptions]="[10, 20, 50, 100]"
		showFirstLastButtons
		aria-label="Select page"
	>
	</mat-paginator>

	<mat-card *ngIf="displayForm" class="form-card">
		<form action="post">

			<mat-form-field>
				<input 
					matInput 
					placeholder="Título" 
					[(ngModel)]="formFields.titulo" 
					name ="title"
					(ngModelChange)="controlSubmit()"
				>
			</mat-form-field>

			<mat-form-field>
				<textarea 
					matInput 
					placeholder="Descrição" 
					[(ngModel)]="formFields.descricao" 
					name ="descricao"
				></textarea>
			</mat-form-field>

			<mat-form-field *ngIf="authors$ | async as authors">
				<mat-label>Autor</mat-label>
				<mat-select [(value)]="formFields.autor" (selectionChange)="controlSubmit()">
				  <mat-option *ngFor="let author of authors.data" [value]="author.id">
					{{author.name}}
				  </mat-option>
				</mat-select>
			</mat-form-field>

			<mat-form-field *ngIf="publishers$ | async as publishers">
				<mat-label>Editora</mat-label>
				<mat-select [(value)]="formFields.editora" (selectionChange)="controlSubmit()">
				  <mat-option *ngFor="let publisher of publishers.data" [value]="publisher.id">
					{{publisher.name}}
				  </mat-option>
				</mat-select>
			</mat-form-field>

			<mat-form-field>
				<input 
					matInput 
					placeholder="Quantidade" 
					name ="availableAmount"
					type = "number"
					min = "1"
					[(ngModel)]="formFields.quantidade" 
				>
			</mat-form-field>

			<button 
				mat-raised-button 
				color="primary" 
				type="submit" 
				(click)="onSubmit()" 
				[disabled]="this.disableSubmit"
			>
				Adicionar
			</button>

		</form>
	</mat-card>


</mat-card>
